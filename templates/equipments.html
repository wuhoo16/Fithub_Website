{% extends 'base.html' %}

{% block head %}
    <!-- Vars: equipmentArray, start, end, page_number, num_pages-->

    <title>Equipment Model Page</title>
    <script>
        function sortSelect(sortMethod)
        {
            document.getElementById("sortSelectionButton").innerHTML = sortMethod;

        }
    </script>

{% endblock %}

{% block body %}
<div class="exercise-div container-fluid">
    <div class="jumbotron-exercise jumbotron jumbotron-fluid text-center">
        <h1 class="modelHeader">Find your gear</h1>
        <p class="modelDescription">Check out our selection of fitness equipment.</p>
    </div>
    <div id="mySidenav" class="sidenav">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">&times;</a>
        <form id="equipmentFilterForm" action="{{ url_for('equipments', page_number=1) }}" method="post">
            <ul class="checkbox-menu">
                <li class="dropdown-header">Price</li>
                <li>
                    <label> <input type="checkbox" name='checkedPriceRange' value="0 50"> $0 - $50 </label>
                </li>
                <li>
                    <label><input type="checkbox" name='checkedPriceRange' value="50 100"> $50 - $100 </label>
                </li>
                <li>
                    <label><input type="checkbox" name='checkedPriceRange' value="100 9999"> $100+ </label>
                </li>
                <li class="dropdown-header">Category</li>
                <li>
                    <label><input type="checkbox" name='checkedEquipmentCategories' value="Barbell"> Barbell </label>
                </li>
                <li>
                    <label><input type="checkbox" name='checkedEquipmentCategories' value="Bench"> Bench </label>
                </li>
                <li>
                    <label><input type="checkbox" name='checkedEquipmentCategories' value="Dumbbell"> Dumbbell </label>
                </li>
                <li>
                    <label><input type="checkbox" name='checkedEquipmentCategories' value="Exercise mat"> Exercise Mat </label>
                </li>
                <li>
                    <label><input type="checkbox" name='checkedEquipmentCategories' value="EZ-Bar"> EZ-Bar </label>
                </li>
                <li>
                    <label><input type="checkbox" name='checkedEquipmentCategories' value="Kettlebell"> Kettlebell </label>
                </li>
                <li style="text-align: center; margin-top: 1rem;">
                    <button class="reset-button btn btn-outline-light" type="submit" name="Reset" value="clicked">Reset</button>
                    <button class="filter-button btn btn-outline-light" type="button" name="Filter" onclick="verifyCheckBoxesAndSubmit('equipmentFilterForm')">Filter</button>
                </li>
            </ul>
        </form>
        <!-- dropdown for sorting menu -->
        <div class="dropdown">
            <button type="button" name="sortSelectionButton" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" id="sortSelectionButton">Sort results by</button>
            <div class="dropdown-menu">
                <a class="dropdown-item" href="#" onclick="sortSelect('No Sorting')">No Sorting</a>
                <a class="dropdown-item" href="#" onclick="sortSelect('Name, A to Z')">Name, A to Z</a>
                <a class="dropdown-item" href="#" onclick="sortSelect('Price, low to high')">Price, low to high</a>
                <a class="dropdown-item" href="#" onclick="sortSelect('Category, A to Z')">Category, A to Z</a>
                <a class="dropdown-item" href="#" onclick="sortSelect('Seller location, A to Z')">Seller location, A to Z</a>
            </div>
        </div>
    </div>

    <!-- Use any element to open the sidenav -->
    <div>
        <button class="filter-open-button" onclick="openNav()">Filter and Sort</button>
        <a href="#"><img class="ascending-button" src="/static/arrow.png" alt="Ascending" onclick="sortAscending();"></a>
        <a href="#"><img class="descending-button" src="/static/arrow.png" alt="Descending" onclick="sortDescending();"></a>
    </div>

    <!-- Add all page content inside this div if you want the side nav to push page content to the right (not used if you only want the sidenav to sit on top of the page -->
    <div id="main">
        <div class="grid-div container-fluid" id="modelGrid">
        {% set numRows = ((end + 1) - start) // 3 %}
        {% set remainder = ((end + 1) - start) % 3 %}
        {% for i in range(numRows) %}
            <div class="row justify-content-center" id="row {{ i|string }}">
            {% for offset in range(3) %}
                <div class="col-md-4 p-4">
                    <div class="card card-style h-100 pt-4">
                    {% if equipmentArray[start + 3*i+offset].replacePictureFlag %}
                        <img class="card-img-top card-image-style img-fluid mx-auto" src="/../static/{{ equipmentArray[start+3*i+offset].picture }}" alt="{{ equipmentArray[start + 3*i+offset].name }}">
                    {% else %}
                        <img class="card-img-top card-image-style img-fluid mx-auto" src="{{ equipmentArray[start+3*i+offset].picture }}" onerror="this.onerror=null; this.src='{{ equipmentArray[start + 3*i+offset].picture }}'"; alt="{{ equipmentArray[start + 3*i+offset].name }}">
                    {% endif %}
                        <div class="card-body">
                            <h2 class="card-title text-center">{{ equipmentArray[start + 3*i+offset].name }}</h2>
                            <p class="card-text">
                                <ul class="equipmentData list-unstyled">
                                    <li style="padding-bottom: 0.5em; padding-left: 1em; padding-top: 1em;" id="priceText_{{ start + 3*i+offset }}"><b>Price: </b>{{ equipmentArray[start + 3*i+offset].price }} USD</li>
                                    <li style="padding-bottom: 0.5em; padding-left: 1em;" id="categoryText_{{ start + 3*i+offset }}"><b>Category: </b>{{ equipmentArray[start + 3*i+offset].equipmentCategory }}</li>
                                    <li style="padding-left: 1em;" id="sellerLocationText_{{ start + 3*i+offset }}"><b>Seller Location: </b>{{ equipmentArray[start + 3*i+offset].location }}</li>
                                </ul>
                            </p>
                            <a href="{{ url_for('equipment_instance', arrayIndex=equipmentArray[start + 3*i+offset].arrayIndex) }}" class="stretched-link" id="instancePageLink_{{ start + 3*i+offset }}"></a>
                        </div>
                    </div>
                </div>
            {% endfor %}
            </div>
        {% endfor %}

        {% if remainder > 0 %}
            <div class="row" id="bottomRow">
            {% for i in range(-remainder, 0) %}
                <div class="col-md-4 p-4">
                    <div class="card card-style h-100 pt-4">
                        {% if equipmentArray[end + 1 + i].replacePictureFlag %}
                            <img class="card-img-top card-image-style img-fluid mx-auto" src="/../static/{{ equipmentArray[end + 1 + i].picture }}" alt="{{ equipmentArray[end + 1 + i].name }}">
                        {% else %}
                            <img class="card-img-top card-image-style img-fluid mx-auto" src="{{ equipmentArray[end + 1 + i].picture }}" onerror="this.onerror=null; this.src='{{ equipmentArray[end + 1 + i].picture }}'"; alt="{{ equipmentArray[end + 1 + i].name }}">
                        {% endif %}
                        <div class="card-body">
                            <h2 class="card-title text-center">{{ equipmentArray[end + 1 + i].name }}</h2>
                            <p class="card-text">
                                <ul class="equipmentData list-unstyled">
                                    <li style="padding-bottom: 0.5em; padding-left: 1em; padding-top: 1em;" id="priceText_{{ end + 1 + i }}"><b>Price: </b>{{ equipmentArray[end + 1 + i].price }} USD</li>
                                    <li style="padding-bottom: 0.5em; padding-left: 1em;" id="categoryText_{{ end + 1 + i }}"><b>Category: </b>{{ equipmentArray[end + 1 + i].equipmentCategory }}</li>
                                    <li style="padding-left: 1em;" id="sellerLocationText_{{ end + 1 + i }}"><b>Seller Location: </b>{{ equipmentArray[end + 1 + i].location }}</li>
                                </ul>
                            </p>
                            <a href="{{ url_for('equipment_instance', arrayIndex=equipmentArray[end + 1 + i].arrayIndex) }}" class="stretched-link"></a>
                        </div>
                    </div>
                </div>
            {% endfor %}
            </div>
        {% endif %}
        </div>

        <ul class="pagination justify-content-center" style="margin: 20px;">
            <!--Previous Page Button-->
            {% if page_number == 1 %}
                <li class="page-item disabled"><a class="page-link" href="">Previous</a></li>
            {% else %}
                <li class="page-item"><a class="page-link" href="{{ url_for('equipments', page_number=page_number-1) }}">Previous</a></li>
            {% endif %}


            <!--All Pages Buttons-->
            {% for i in range(1, num_pages+1) %}
                {% if i == page_number %}
                    <li class="page-item active"><a class="page-link" href="{{ url_for('equipments', page_number=i) }}">{{i}}</a></li>
                {% else %}
                    <li class="page-item"><a class="page-link" href="{{ url_for('equipments', page_number=i) }}">{{i}}</a></li>
                {% endif %}    
            {% endfor %}

            <!--Next Page Button-->
            {% if page_number == num_pages %}
                <li class="page-item disabled"><a class="page-link" href="">Next</a></li>
            {% else %}
                <li class="page-item"><a class="page-link" href="{{ url_for('equipments', page_number=page_number+1) }}">Next</a></li>
            {% endif %}
        </ul>
    </div>
</div>
{% endblock %}